{
    "openapi": "3.0.0",
    "info": {
        "title": "FirmWizard API",
        "description": "AI-powered marketing platform for law firms",
        "contact": {
            "email": "support@firmwizard.com"
        },
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "http://127.0.0.1:8000",
            "description": "Local Development Server"
        }
    ],
    "paths": {
        "/api/ai-agents": {
            "get": {
                "tags": [
                    "AI Agents"
                ],
                "summary": "Get available AI agents",
                "operationId": "afb503bbf1ee5f5e7f555b0e6d089aa9",
                "responses": {
                    "200": {
                        "description": "List of available AI agents"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/ai-agents/trigger/{agentType}": {
            "post": {
                "tags": [
                    "AI Agents"
                ],
                "summary": "Trigger an AI agent",
                "operationId": "6ef154775d6cab3e83a8a46aa9d25aa6",
                "parameters": [
                    {
                        "name": "agentType",
                        "in": "path",
                        "description": "Type of AI agent to trigger",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "blog_post",
                                "competitor_analysis",
                                "website_analysis",
                                "gbp_analysis",
                                "google_ads",
                                "lsa_ads",
                                "meta_ads",
                                "backlinks",
                                "analytics",
                                "firm_profile"
                            ]
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "input_data": {
                                        "type": "object"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Agent triggered successfully"
                    },
                    "400": {
                        "description": "Invalid agent type"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/ai-agents/jobs/{job}": {
            "get": {
                "tags": [
                    "AI Agents"
                ],
                "summary": "Get AI job results",
                "operationId": "eec596cc81637573504b78279d009928",
                "parameters": [
                    {
                        "name": "job",
                        "in": "path",
                        "description": "AI Job ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Job details and results"
                    },
                    "403": {
                        "description": "Forbidden"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/crawler/scripts": {
            "get": {
                "tags": [
                    "Crawler"
                ],
                "summary": "List available crawler scripts",
                "operationId": "7ef5358c6a329e7fe4ee29feebb5139c",
                "responses": {
                    "200": {
                        "description": "List of available scripts",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "scripts": {
                                            "type": "array",
                                            "items": {
                                                "type": "string"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/crawler/page": {
            "post": {
                "tags": [
                    "Crawler"
                ],
                "summary": "Crawl and store a page for competitor analysis",
                "operationId": "20703fc1044fd465dae49506099a5d0c",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "competitor_id",
                                    "url"
                                ],
                                "properties": {
                                    "competitor_id": {
                                        "type": "integer",
                                        "example": 1
                                    },
                                    "url": {
                                        "type": "string",
                                        "example": "https://example.com"
                                    },
                                    "save_to_db": {
                                        "type": "boolean",
                                        "example": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Page crawled successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "page_id": {
                                            "type": "integer"
                                        },
                                        "data": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/crawler/pages/{competitorId}": {
            "get": {
                "tags": [
                    "Crawler"
                ],
                "summary": "Get crawled pages for a competitor",
                "operationId": "77680226ca67857e31822fb545a44c5b",
                "parameters": [
                    {
                        "name": "competitorId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of crawled pages"
                    }
                }
            }
        },
        "/api/crawler/find-competitors": {
            "post": {
                "tags": [
                    "Crawler"
                ],
                "summary": "Find competitors using Google Places API",
                "operationId": "4745db9af1d3f6f8dce358b6c16c7d88",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "collection_id"
                                ],
                                "properties": {
                                    "collection_id": {
                                        "type": "integer",
                                        "example": 1
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Competitor search completed",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "run_id": {
                                            "type": "integer"
                                        },
                                        "competitors_found": {
                                            "type": "integer"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/crawler/collections": {
            "get": {
                "tags": [
                    "Crawler"
                ],
                "summary": "Get all collections",
                "operationId": "30bff1bc3dd5ec0ed2cc732d5800581b",
                "responses": {
                    "200": {
                        "description": "List of collections"
                    }
                }
            },
            "post": {
                "tags": [
                    "Crawler"
                ],
                "summary": "Create a new collection",
                "operationId": "021aae38ba3a1f94abfaab62fafcd550",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "firm_id",
                                    "firm_location_id",
                                    "name",
                                    "query"
                                ],
                                "properties": {
                                    "firm_id": {
                                        "type": "integer"
                                    },
                                    "firm_location_id": {
                                        "type": "integer"
                                    },
                                    "name": {
                                        "type": "string"
                                    },
                                    "query": {
                                        "type": "string"
                                    },
                                    "enabled": {
                                        "type": "boolean"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Collection created"
                    }
                }
            }
        },
        "/api/crawler/firms": {
            "get": {
                "tags": [
                    "Crawler"
                ],
                "summary": "Get list of firms",
                "operationId": "c149cb2f1718d2e1c39bbe757b3a3086",
                "responses": {
                    "200": {
                        "description": "List of firms"
                    }
                }
            }
        },
        "/api/crawler/firm-locations": {
            "get": {
                "tags": [
                    "Crawler"
                ],
                "summary": "Get list of firm locations",
                "operationId": "4c6ae1950477beabe8ec46289dc56404",
                "parameters": [
                    {
                        "name": "firm_id",
                        "in": "query",
                        "description": "Filter by firm ID",
                        "required": false,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of firm locations"
                    }
                }
            }
        },
        "/api/crawler/firm-profiles": {
            "get": {
                "tags": [
                    "Crawler"
                ],
                "summary": "Get list of firm profiles",
                "operationId": "5602c500f75ab77c1eefc274d4b6865e",
                "parameters": [
                    {
                        "name": "firm_id",
                        "in": "query",
                        "description": "Filter by firm ID",
                        "required": false,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of firm profiles"
                    }
                }
            }
        },
        "/api/gbp/{locationId}/sync": {
            "get": {
                "tags": [
                    "GBP Locations"
                ],
                "summary": "Sync GBP location with Google Places data",
                "description": "Converts GBP location_id to place_id and syncs full business data from Google Places API",
                "operationId": "syncGbpLocation",
                "parameters": [
                    {
                        "name": "locationId",
                        "in": "path",
                        "description": "GBP location ID (numeric string)",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "example": "9393481967568809184"
                        }
                    },
                    {
                        "name": "X-API-Key",
                        "in": "header",
                        "description": "N8N API Key for authentication",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "api_key",
                        "in": "query",
                        "description": "N8N API Key for authentication (alternative to header)",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "firm_id",
                        "in": "query",
                        "description": "Firm ID for multi-tenant support",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successfully synced location data",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "locationId": {
                                            "type": "string",
                                            "example": "9393481967568809184"
                                        },
                                        "placeId": {
                                            "type": "string",
                                            "example": "ChIJr7uyr1-3dYgRhHY8ZJTAiF0"
                                        },
                                        "data": {
                                            "properties": {
                                                "name": {
                                                    "type": "string"
                                                },
                                                "address": {
                                                    "type": "string"
                                                },
                                                "phone": {
                                                    "type": "string"
                                                },
                                                "website": {
                                                    "type": "string"
                                                },
                                                "hours": {
                                                    "type": "object"
                                                },
                                                "categories": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "string"
                                                    }
                                                },
                                                "rating": {
                                                    "type": "number",
                                                    "example": 4.6
                                                },
                                                "reviews": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object"
                                                    }
                                                },
                                                "photos": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object"
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "error": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "example": "Unauthorized"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "GBP integration not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "error": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ]
            }
        },
        "/api/integrations/platforms": {
            "get": {
                "tags": [
                    "Integrations"
                ],
                "summary": "Get available integration platforms",
                "operationId": "4cdb37f87b572a0ba901cea6fadadbd4",
                "responses": {
                    "200": {
                        "description": "List of available platforms"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/integrations": {
            "get": {
                "tags": [
                    "Integrations"
                ],
                "summary": "List all integrations for current firm",
                "operationId": "c5d16f47b7ca9dbb68db4b84ed4592e0",
                "responses": {
                    "200": {
                        "description": "List of integrations"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Integrations"
                ],
                "summary": "Create a new integration",
                "operationId": "8c21532b11425850c7f499a7c18f785c",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "platform",
                                    "name",
                                    "auth_type",
                                    "credentials"
                                ],
                                "properties": {
                                    "platform": {
                                        "type": "string",
                                        "example": "wordpress"
                                    },
                                    "name": {
                                        "type": "string",
                                        "example": "Main WordPress Site"
                                    },
                                    "auth_type": {
                                        "type": "string",
                                        "enum": [
                                            "bearer_token",
                                            "oauth2",
                                            "jwt",
                                            "openid"
                                        ]
                                    },
                                    "credentials": {
                                        "type": "object"
                                    },
                                    "config": {
                                        "type": "object"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Integration created"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/integrations/{integration}": {
            "get": {
                "tags": [
                    "Integrations"
                ],
                "summary": "Get a single integration",
                "operationId": "e67c7da0cb42dd2d10183d9bad340e3d",
                "parameters": [
                    {
                        "name": "integration",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Integration details"
                    },
                    "404": {
                        "description": "Integration not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            },
            "put": {
                "tags": [
                    "Integrations"
                ],
                "summary": "Update an integration",
                "operationId": "d086cef33716f19ffc22dfab0b6359f9",
                "parameters": [
                    {
                        "name": "integration",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "credentials": {
                                        "type": "object"
                                    },
                                    "config": {
                                        "type": "object"
                                    },
                                    "status": {
                                        "type": "string",
                                        "enum": [
                                            "active",
                                            "inactive",
                                            "error"
                                        ]
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Integration updated"
                    },
                    "404": {
                        "description": "Integration not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Integrations"
                ],
                "summary": "Delete an integration",
                "operationId": "160ce37d67a65cb4dface382e28198d7",
                "parameters": [
                    {
                        "name": "integration",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Integration deleted"
                    },
                    "404": {
                        "description": "Integration not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/integrations/{integration}/test": {
            "post": {
                "tags": [
                    "Integrations"
                ],
                "summary": "Test integration connection",
                "operationId": "ca618e28c6efa5573399af06bd67de8c",
                "parameters": [
                    {
                        "name": "integration",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Connection test result"
                    },
                    "404": {
                        "description": "Integration not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/integrations/auth-fields/{authType}": {
            "get": {
                "tags": [
                    "Integrations"
                ],
                "summary": "Get auth fields for a specific auth type",
                "operationId": "45d8e0dfed3884848b95a86f4c7be91d",
                "parameters": [
                    {
                        "name": "authType",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "bearer_token",
                                "oauth2",
                                "jwt",
                                "openid"
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Auth fields"
                    },
                    "400": {
                        "description": "Invalid auth type"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/api/n8n/integrations/active": {
            "get": {
                "tags": [
                    "N8N Integrations"
                ],
                "summary": "List active integrations for a firm",
                "description": "Returns all active integrations for a specific firm. Requires API key authentication.",
                "operationId": "listActiveIntegrations",
                "parameters": [
                    {
                        "name": "X-API-Key",
                        "in": "header",
                        "description": "N8N API Key for authentication",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "api_key",
                        "in": "query",
                        "description": "N8N API Key for authentication (alternative to header)",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "firm_id",
                        "in": "query",
                        "description": "The ID of the firm to retrieve integrations for",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful response with list of active integrations",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "firm_id": {
                                            "type": "integer",
                                            "example": 1
                                        },
                                        "integrations": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "id": {
                                                        "type": "integer",
                                                        "example": 1
                                                    },
                                                    "platform": {
                                                        "type": "string",
                                                        "example": "google_gbp"
                                                    },
                                                    "name": {
                                                        "type": "string",
                                                        "example": "Google Business Profile"
                                                    },
                                                    "display_name": {
                                                        "type": "string",
                                                        "example": "Google Business Profile"
                                                    },
                                                    "auth_type": {
                                                        "type": "string",
                                                        "example": "oauth2"
                                                    },
                                                    "last_synced_at": {
                                                        "type": "string",
                                                        "format": "date-time",
                                                        "example": "2025-11-30T12:00:00+00:00",
                                                        "nullable": true
                                                    },
                                                    "last_sync_status": {
                                                        "type": "string",
                                                        "example": "success",
                                                        "nullable": true
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        },
                                        "count": {
                                            "type": "integer",
                                            "example": 3
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - firm_id is required",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "example": "firm_id is required"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized - Invalid or missing API key",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "example": "Unauthorized"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ]
            }
        },
        "/onboarding": {
            "get": {
                "tags": [
                    "Onboarding"
                ],
                "summary": "Get onboarding wizard",
                "description": "Show onboarding wizard landing/current step",
                "operationId": "b58cca8420098ad551a5f39ffcdb5e81",
                "responses": {
                    "200": {
                        "description": "Display onboarding wizard"
                    }
                }
            }
        },
        "/onboarding/step/{step}": {
            "get": {
                "tags": [
                    "Onboarding"
                ],
                "summary": "Get specific wizard step",
                "description": "Show specific wizard step",
                "operationId": "1ffa9c8fa025e56616be9e51c4abff6c",
                "parameters": [
                    {
                        "name": "step",
                        "in": "path",
                        "description": "Step number (1-5)",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Display wizard step"
                    }
                }
            }
        }
    },
    "components": {
        "securitySchemes": {
            "ApiKeyAuth": {
                "type": "apiKey",
                "description": "N8N API Key for authentication",
                "name": "X-API-Key",
                "in": "header"
            }
        }
    },
    "tags": [
        {
            "name": "AI Agents",
            "description": "AI Agents"
        },
        {
            "name": "Crawler",
            "description": "Crawler"
        },
        {
            "name": "GBP Locations",
            "description": "GBP Locations"
        },
        {
            "name": "Integrations",
            "description": "Integrations"
        },
        {
            "name": "N8N Integrations",
            "description": "N8N Integrations"
        },
        {
            "name": "Onboarding",
            "description": "Onboarding"
        }
    ]
}